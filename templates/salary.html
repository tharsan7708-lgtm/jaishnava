<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Jaishnava Designers</title>
  <link rel="icon" href="{{ url_for('static', filename='images/profile.png') }}" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">

  <!-- Month & Year Filter Form -->
  <form method="POST" class="mb-6">
    <div class="flex flex-wrap items-center gap-4">
      <div>
        <label for="month" class="block text-sm font-semibold text-gray-700">Month</label>
        <select name="month" id="month" class="p-2 rounded border border-gray-300">
          {% for m in range(1, 13) %}
            <option value="{{ m }}" {% if m == selected_month %}selected{% endif %}>{{ m }}</option>
          {% endfor %}
        </select>
      </div>
      <div>
        <label for="year" class="block text-sm font-semibold text-gray-700">Year</label>
        <select name="year" id="year" class="p-2 rounded border border-gray-300">
          {% for y in range(current_year - 3, current_year + 1) %}
            <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="self-end">
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Filter</button>
      </div>
    </div>
  </form>

  <!-- Title -->
  <h1 class="text-3xl font-bold text-center mb-8 text-blue-700">Salary Summary</h1>

  <!-- Salary Table -->
  <div class="overflow-x-auto bg-white shadow-md rounded-xl p-4 mb-4">
    <table class="min-w-full divide-y divide-gray-200 text-center">
      <thead class="bg-blue-600 text-white">
        <tr>
          <th class="py-3 px-4">EMP ID</th>
          <th class="py-3 px-4">EMPLOYEE NAME</th>
          <th class="py-3 px-4">PRESENT DAYS</th>
          <th class="py-3 px-4">SALARY</th>
          <th class="py-3 px-4">BONUS</th>
          <th class="py-3 px-4">ADVANCE</th>
          <th class="py-3 px-4">PENDING</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
        {% for s in salary_data %}
        <tr class="hover:bg-gray-50">
          <td class="py-2 px-4 font-medium">{{ s.emp_id }}</td>
          <td class="py-2 px-4">{{ s.name }}</td>
          <td class="py-2 px-4">{{ s.present_days }}</td>
          <td class="py-2 px-4 text-green-600 font-semibold">‚Çπ{{ s.salary }}</td>
          <td class="py-2 px-4 text-purple-600 font-semibold">‚Çπ{{ s.bonus }}</td>
          <td class="py-2 px-4 text-red-600">‚Çπ{{ s.advance }}</td>
          <td class="py-2 px-4 {% if s.pending < 0 %}text-red-600{% else %}text-yellow-600{% endif %}">
            ‚Çπ{{ s.pending }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- CSV Download Button -->
  <div class="text-center mb-8">
    <a href="{{ url_for('download_salary_csv', month=selected_month, year=selected_year) }}"
       class="inline-block bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700">
      üìÑ View CSV File
    </a>
  </div>

  <!-- Total Company Summary -->
  <div class="bg-white shadow-md rounded-xl p-6 text-center mb-6 max-w-3xl mx-auto">
    <h2 class="text-xl font-semibold mb-4">Total Company Summary</h2>
    <div class="flex justify-around text-lg flex-wrap gap-4">
      <div><strong>Total Salary:</strong> <span class="text-green-600 font-semibold">‚Çπ{{ total_salary }}</span></div>
      <div><strong>Total Bonus:</strong> <span class="text-purple-600 font-semibold">‚Çπ{{ total_bonus }}</span></div>
      <div><strong>Total Advance:</strong> <span class="text-red-600 font-semibold">‚Çπ{{ total_advance }}</span></div>
      <div><strong>Total Pending:</strong> <span class="text-orange-600 font-semibold">‚Çπ{{ total_pending }}</span></div>
    </div>
  </div>

  <!-- Outstanding Amount Summary -->
  <div class="bg-white shadow-md rounded-xl p-4 text-center mb-6 max-w-3xl mx-auto">
    <h2 class="text-lg font-semibold text-red-700 mb-2">Outstanding Amount (Overpaid)</h2>
    <p class="text-xl text-red-600 font-bold">‚Çπ{{ outstanding_amount }}</p>
  </div>

  <!-- Back to Dashboard -->
  <div class="text-center">
    <a href="/dashboard" class="text-blue-600 hover:underline">‚Üê Back to Dashboard</a>
  </div>

</body>
</html>
